"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(t){_defineProperty(e,t,i[t])})}return e}var defaultOptions={onClass:null,offClass:null,toggle:!0,selected:1,random:!1,autoplay:!0,interval:2e3,loop:!0},classCycles=[],listening=!1,wHeight=window.innerHeight,ClassCycleObj=function(){function i(t,e){_classCallCheck(this,i),this.options=_objectSpread({},defaultOptions,e),this.targets=t,this.reset()}return _createClass(i,[{key:"reset",value:function(){this.inactive=Array.from(this.targets),this.inactive.reverse(),this.active=[],this.done=[],this.complete=!1,this.update(),this.options.autoplay&&this.play()}},{key:"play",value:function(){this.running||this.complete||!this.isVisible()||this.cycle()}},{key:"stop",value:function(){this.complete=!0}},{key:"cycle",value:function(){var t=this;this.running=!0,setTimeout(function(){t.update(),t.running=!1,t.play()},this.options.interval)}},{key:"update",value:function(){var e=this;this.options.random&&shuffle(this.inactive);for(var t=0;t<this.options.selected;t++)if(0<this.inactive.length)this.active.push(this.inactive.pop());else{if(this.options.loop)return void this.reset();this.complete=!0}this.updateClasses(),this.active.map(function(t){return e.done.unshift(e.active.pop())})}},{key:"updateClasses",value:function(){var e=this;this.active.map(function(t){e.options.onClass&&t.classList.add(e.options.onClass),e.options.offClass&&t.classList.remove(e.options.offClass)}),this.inactive.map(function(t){e.options.onClass&&t.classList.remove(e.options.onClass),e.options.offClass&&t.classList.add(e.options.offClass)}),this.done.map(function(t){e.options.onClass&&e.options.toggle&&t.classList.remove(e.options.onClass),e.options.offClass&&e.options.toggle&&t.classList.add(e.options.offClass)})}},{key:"isVisible",value:function(){var i=!1;return Array.from(this.targets).forEach(function(t){var e=t.getBoundingClientRect();e.top<wHeight&&0<e.bottom&&(i=!0)}),i}}]),i}(),initListeners=function(){window.addEventListener("resize",function(){wWidth=window.innerWidth,wHeight=window.innerHeight,checkVisiblility()}),window.addEventListener("scroll",function(){checkVisiblility()})},checkVisiblility=function(){classCycles.map(function(t){t.play()})},shuffle=function(t){for(var e,i,n=t.length;0!==n;)i=Math.floor(Math.random()*n),e=t[n-=1],t[n]=t[i],t[i]=e;return t},main=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof t&&(t=document.querySelectorAll("".concat(t))),t&&t.length){var i=new ClassCycleObj(t,e);return classCycles.push(i),listening||(initListeners(),listening=!0),i}};module.exports=main;
